{% extends "baseGenerar.html" %}
{% load tailwind_tags %}

{% block scripts %}
<script>


</script>


{% endblock %}

{% block content %}

<section class="propietario p-6 rounded-lg relative flex justify-center">

  
  <div class="flex-row flex-wrap w-fit bg-white rounded-lg shadow-md mb-10 p-10" style="width: 60rem;">

    {% if recibo == None and fondodl == None and fondoPasadodl != None %}
    <form method="POST">
        {% csrf_token %}
        <h1 class="text-3xl mb-5 text-center">No hay recibo ni fondo asociado a este mes.</h1>
        <h1 class="text-3xl mb-5 text-center">¿Desea crear un nuevo recibo y fondo?</h1>
    
        <button type="submit" name="CrearReciboYFondo" value="1" class="w-full bg-indigo-900 text-white py-2 px-4 my-4 rounded-lg hover:bg-blue-900 hover:font-semibold hover:text-white transition-all duration-900 ease-in-out scale-100 active:bg-blue-900 active:text-white active:scale-95 max-[900px]:ml-auto max-[900px]:mr-4 mt-5">
            Crear recibo y fondo
        </button>
    </form>


    {% elif recibo == None and fondodl == None and fondoPasadodl == None %}
    <form method="POST">
        {% csrf_token %}
        <h1 class="text-3xl mb-5 text-center">No hay recibo ni fondo asociado a este mes.</h1>
        <h1 class="text-3xl mb-5 text-center">Tampoco hay fondo del mes anterior.</h1>
        <h1 class="text-3xl mb-5 text-center">¿Desea crear un nuevo recibo y fondo que inicie vacío?</h1>
    
        <button type="submit" name="CrearReciboYFondo0" value="1" class="w-full bg-indigo-900 text-white py-2 px-4 my-4 rounded-lg hover:bg-blue-900 hover:font-semibold hover:text-white transition-all duration-900 ease-in-out scale-100 active:bg-blue-900 active:text-white active:scale-95 max-[900px]:ml-auto max-[900px]:mr-4 mt-5">
            Crear recibo y fondo
        </button>
    </form>
    

    {% elif recibo == None and fondodl != None %}

    <form method="POST">
        {% csrf_token %}
        <h1 class="text-3xl mb-5 text-center">No hay recibo asociado a este mes. </h1>
        <h1 class="text-3xl mb-5 text-center">¿Desea crear un nuevo recibo?</h1>

        <button type='submit' value="1" class="w-full bg-indigo-900 text-white py-2 px-4 my-4 rounded-lg hover:bg-blue-900 hover:font-semibold hover:text-white transition-all duration-900 ease-in-out scale-100 active:bg-blue-900 active:text-white active:scale-95 max-[900px]:ml-auto max-[900px]:mr-4 mt-5" name='CrearRecibo'>
            Crear recibo
        </button>
    </form>

    {% else %}
    

      
    <h1 class="text-3xl mb-5">Mes Actual: {{fechaRecibidaLetra}}</h1>
      
    <!-- Sección de presupuesto -->
    <form method="POST">
        {% csrf_token %}
        <div class="mb-5">
            <div class="mb-4">
                <h2 class="text-2xl mb-5 text-gray-800">Presupuesto para {{fechaSiguienteLetra}} </h2>
                
                <!-- Mostrar errores generales del formulario -->
                {% if form_presupuesto.non_field_errors %}
                    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
                        {% for error in form_presupuesto.non_field_errors %}
                            <p>{{ error }}</p>
                        {% endfor %}
                    </div>
                {% endif %}
    
                <!-- Iterar sobre los campos del formulario -->
                {% for field in form_presupuesto %}
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">{{ field.label }}</label>
                        
                        <!-- Campo de fecha personalizado -->
                        {% if field.name == "fecha_pres" %}
                            <input type="date" name="{{ field.name }}" 
                                   class="w-full px-4 py-2 rounded-full border border-gray-300 bg-white focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition duration-300 date-input"
                                   value="{{ field.value|default_if_none:'' }}">
                        {% else %}
                            {{ field }}
                        {% endif %}
    
                        <!-- Mostrar errores específicos del campo -->
                        {% if field.errors %}
                            <div class="text-red-600 text-sm mt-1">
                                {% for error in field.errors %}
                                    <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                        {% endif %}
    
                        <!-- Mostrar texto de ayuda (help_text) -->
                        {% if field.help_text %}
                            <p class="text-gray-500 text-sm mt-1">{{ field.help_text }}</p>
                        {% endif %}
                    </div>
                {% endfor %}
    
                <!-- Botón de envío -->
                <button class="w-full bg-indigo-900 text-white py-2 px-4 my-4 rounded-lg hover:bg-blue-900 hover:font-semibold hover:text-white transition-all duration-900 ease-in-out scale-100 active:bg-blue-900 active:text-white active:scale-95 max-[900px]:ml-auto max-[900px]:mr-4" style="width: 16rem;" name='agregarPresupuesto'>
                    Agregar presupuesto
                </button>
            </div>
        </div>
    </form>

        <div class="bg-white shadow-md rounded-lg p-6 w-full mb-10">
            <h2 class="text-2xl text-gray-800 mb-4">Presupuesto</h2>

            <div class="overflow-x-auto">
                <table class="min-w-full bg-white border border-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Descripción</th>
                            <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Monto</th>
                        </tr>
                    </thead>
                    <tbody>

                        <!-- Aquí va cada fila, hay 2 ejemplos de filas -->

                        <!-- Primer ejemplo -->
                        {% for monto in monto_presupuestos %}
                            <tr class="hover:bg-gray-50 transition duration-200">
                                <td class="border px-4 py-2 text-sm text-gray-700">{{monto.titulo}}</td>
                                <td class="border px-4 py-2 text-sm text-gray-700">{{monto.monto}}</td>
                            </tr>
                        {% endfor %}

                    </tbody>
                </table>
            </div>
                    
        </div> 

    <!-- Sección de gastos directos -->
    <form method="POST">
        {% csrf_token %}
        <div class="mb-5">

            <div class="mb-4">

                <h2 class="text-2xl mb-5 text-gray-800">Gastos directos de cada apartamento para {{fechaSiguienteLetra}}</h2>
                {% if form_GastoDirecto.non_field_errors %}
                    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
                        {% for error in form_GastoDirecto.non_field_errors %}
                            <p>{{ error }}</p>
                        {% endfor %}
                    </div>
                {% endif %}
    
                <!-- Iterar sobre los campos del formulario -->
                {% for field in form_GastoDirecto %}
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">{{ field.label }}</label>
                        
                        <!-- Campo de fecha personalizado -->
                        {% if field.name == "fecha_pres" %}
                            <input type="date" name="{{ field.name }}" 
                                   class="w-full px-4 py-2 rounded-full border border-gray-300 bg-white focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition duration-300 date-input"
                                   value="{{ field.value|default_if_none:'' }}">
                        {% else %}
                            {{ field }}
                        {% endif %}
    
                        <!-- Mostrar errores específicos del campo -->
                        {% if field.errors %}
                            <div class="text-red-600 text-sm mt-1">
                                {% for error in field.errors %}
                                    <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                        {% endif %}
    
                        <!-- Mostrar texto de ayuda (help_text) -->
                        {% if field.help_text %}
                            <p class="text-gray-500 text-sm mt-1">{{ field.help_text }}</p>
                        {% endif %}
                    </div>
                {% endfor %}

                <button class="w-full bg-indigo-900 text-white py-2 px-4 my-4 rounded-lg hover:bg-blue-900 hover:font-semibold hover:text-white transition-all duration-900 ease-in-out scale-100 active:bg-blue-900 active:text-white active:scale-95 max-[900px]:ml-auto max-[900px]:mr-4" style="width: 16rem;" name='agregarGastoDirecto'>
                    Agregar gasto directo
                </button>

            </div>
        
        </div>
    </form>

    <div class="bg-white shadow-md rounded-lg p-6 w-full mb-10">
        <h2 class="text-2xl text-gray-800 mb-4">Gastos directos</h2>

        <div class="overflow-x-auto">
            <table class="min-w-full bg-white border border-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Descripción</th>
                        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Monto</th>
                    </tr>
                </thead>
                <tbody>

                    <!-- Aquí va cada fila, hay 2 ejemplos de filas -->

                    {% for monto_gd in monto_gastosDirectos %}
                        <tr class="hover:bg-gray-50 transition duration-200">
                            <td class="border px-4 py-2 text-sm text-gray-700">{{monto_gd.titulo}}</td>
                            <td class="border px-4 py-2 text-sm text-gray-700">{{monto_gd.monto}}</td>
                        </tr>
                    {% endfor %}


                </tbody>
            </table>
        </div>
                


    </div> 


    <!-- Sección de gastos aplicados -->
    <form method="POST">
        {% csrf_token %}
        <div class="mb-5">

            <div class="mb-4">

                <h2 class="text-2xl mb-5 text-gray-800">Gastos aplicados en {{fechaRecibidaLetra}}</h2>

                {% if form_GastoAplicado.non_field_errors %}
                <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
                    {% for error in form_GastoAplicado.non_field_errors %}
                        <p>{{ error }}</p>
                    {% endfor %}
                </div>
            {% endif %}

            <!-- Iterar sobre los campos del formulario -->
            {% for field in form_GastoAplicado %}
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">{{ field.label }}</label>
                    
                    <!-- Campo de fecha personalizado -->
                    {% if field.name == "fecha_gasto" %}
                        <input type="date" name="{{ field.name }}" 
                            class="w-full px-4 py-2 rounded-full border border-gray-300 bg-white focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition duration-300 date-input"
                            value="{{ field.value|default_if_none:'' }}">
                    {% else %}
                        {{ field }}
                    {% endif %}

                    <!-- Mostrar errores específicos del campo -->
                    {% if field.errors %}
                        <div class="text-red-600 text-sm mt-1">
                            {% for error in field.errors %}
                                <p>{{ error }}</p>
                            {% endfor %}
                        </div>
                    {% endif %}

                    <!-- Mostrar texto de ayuda (help_text) -->
                    {% if field.help_text %}
                        <p class="text-gray-500 text-sm mt-1">{{ field.help_text }}</p>
                    {% endif %}
                </div>
            {% endfor %}

                <button class="w-full bg-indigo-900 text-white py-2 px-4 my-4 rounded-lg hover:bg-blue-900 hover:font-semibold hover:text-white transition-all duration-900 ease-in-out scale-100 active:bg-blue-900 active:text-white active:scale-95 max-[900px]:ml-auto max-[900px]:mr-4" style="width: 16rem;" name='agregarGastoAplicado'>
                    Agregar gasto aplicado
                </button>

            </div>
        
        </div>
    </form>
    <div class="bg-white shadow-md rounded-lg p-6 w-full mb-10">
        <h2 class="text-2xl text-gray-800 mb-4">Gastos aplicados</h2>

        <div class="overflow-x-auto">
            <table class="min-w-full bg-white border border-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Descripción</th>
                        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Monto</th>
                    </tr>
                </thead>
                <tbody>

                    <!-- Aquí va cada fila, hay 2 ejemplos de filas -->

                    {% for monto_g in monto_gastos %}
                        <tr class="hover:bg-gray-50 transition duration-200">
                            <td class="border px-4 py-2 text-sm text-gray-700">{{monto_g.titulo}}</td>
                            <td class="border px-4 py-2 text-sm text-gray-700">{{monto_g.monto}}</td>
                        </tr>
                    {% endfor %}


                </tbody>
            </table>
        </div>
                


    </div>


    <!-- Sección de fondo para gastos imprevistos -->
    <form method="POST">

        <div class="mb-5">

            <div class="mb-4">

                <h2 class="text-2xl mb-5 text-gray-800">Fondo para gastos imprevistos para {{fechaSiguienteLetra}} </h2>
                {% csrf_token %}
        
                    {% if form_fondo.non_field_errors %}
                        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
                            {% for error in form_fondo.non_field_errors %}
                                <p>{{ error }}</p>
                            {% endfor %}
                        </div>
                    {% endif %}
        
                    <!-- Iterar sobre los campos del formulario -->
                    {% for field in form_fondo %}
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">{{ field.label }}</label>
                            
                                {{ field }}
        
                            <!-- Mostrar errores específicos del campo -->
                            {% if field.errors %}
                                <div class="text-red-600 text-sm mt-1">
                                    {% for error in field.errors %}
                                        <p>{{ error }}</p>
                                    {% endfor %}
                                </div>
                            {% endif %}
        
                            <!-- Mostrar texto de ayuda (help_text) -->
                            {% if field.help_text %}
                                <p class="text-gray-500 text-sm mt-1">{{ field.help_text }}</p>
                            {% endif %}
                        </div>
                    {% endfor %}
                <button class="w-full bg-indigo-900 text-white py-2 px-4 my-4 rounded-lg hover:bg-blue-900 hover:font-semibold hover:text-white transition-all duration-900 ease-in-out scale-100 active:bg-blue-900 active:text-white active:scale-95 max-[900px]:ml-auto max-[900px]:mr-4" style="width: 16rem;" name='agregarFondoImprevisto'>
                    Establecer fondo
                </button>

            </div>
        
        </div>
    </form>

    <div class="bg-white shadow-md rounded-lg p-6 w-full mb-10">
        <h2 class="text-2xl text-gray-800 mb-4">Fondo para gastos imprevistos</h2>

        <div class="overflow-x-auto">
            <table class="min-w-full bg-white border border-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Monto</th>
                    </tr>
                </thead>
                <tbody>

                    <!-- Aquí va la única fila -->

                    <tr class="hover:bg-gray-50 transition duration-200">
                        <td class="border px-4 py-2 text-sm text-gray-700">{{fondoImprevisto.monto_pres_dl}}$</td>
                    </tr>


                </tbody>
            </table>
        </div>
                


    </div>



    <!-- Sección de comentarios -->
    <form method="POST">

        <div class="mb-5">

            <div class="mb-4">

                <h2 class="text-2xl mb-5 text-gray-800">Comentarios del recibo</h2>
                {% csrf_token %}
            
                {% if form_comentario.non_field_errors %}
                    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
                        {% for error in form_comentario.non_field_errors %}
                            <p>{{ error }}</p>
                        {% endfor %}
                    </div>
                {% endif %}

                <!-- Iterar sobre los campos del formulario -->
                {% for field in form_comentario %}
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">{{ field.label }}</label>
                        
                            {{ field }}

                        <!-- Mostrar errores específicos del campo -->
                        {% if field.errors %}
                            <div class="text-red-600 text-sm mt-1">
                                {% for error in field.errors %}
                                    <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                        {% endif %}

                        <!-- Mostrar texto de ayuda (help_text) -->
                    </div>
                {% endfor %}
                <button class="w-full bg-indigo-900 text-white py-2 px-4 my-4 rounded-lg hover:bg-blue-900 hover:font-semibold hover:text-white transition-all duration-900 ease-in-out scale-100 active:bg-blue-900 active:text-white active:scale-95 max-[900px]:ml-auto max-[900px]:mr-4" style="width: 16rem;" name='agregarComentario'>
                    Agregar comentario
                </button>

            </div>
        
        </div>
    </form>

    <div class="bg-white shadow-md rounded-lg p-6 w-full mb-10">
        <h2 class="text-2xl text-gray-800 mb-4">Comentarios</h2>

        <div class="overflow-x-auto">
            <table class="min-w-full bg-white border border-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Descripción</th>
                    </tr>
                </thead>
                <tbody>

                    <!-- Aquí va cada fila, hay 2 ejemplos de filas -->
                     {% for comentario in comentarios %}
                        <tr class="hover:bg-gray-50 transition duration-200">
                            <td class="border px-4 py-2 text-sm text-gray-700">{{comentario.desc_comentario}}</td>
                        </tr>
                    {%endfor%}

                </tbody>
            </table>
        </div>
                


    </div>


    <form method="POST">
        {% csrf_token %}
        <button class="w-full bg-indigo-900 text-white py-2 px-4 my-4 rounded-lg hover:bg-blue-900 hover:font-semibold hover:text-white transition-all duration-900 ease-in-out scale-100 active:bg-blue-900 active:text-white active:scale-95 max-[900px]:ml-auto max-[900px]:mr-4" name='redirectVerRecibo' value='1'>
            Ver recibo
        </button>
    </form>

    {% endif %}

</section>

{% endblock %}